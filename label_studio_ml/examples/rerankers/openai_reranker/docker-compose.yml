version: "3.8"

services:
  ml-backend:
    container_name: openai-reranker
    image: humansignal/openai-reranker:v0
    build:
      context: .
      args:
        TEST_ENV: ${TEST_ENV}
    environment:
      # specify these parameters if you want to use basic auth for the model server
      - BASIC_AUTH_USER=
      - BASIC_AUTH_PASS=
      # set the log level for the model server
      - LOG_LEVEL=DEBUG
      # any other parameters that you want to pass to the model server
      - ANY=PARAMETER
      # specify the number of workers and threads for the model server
      - WORKERS=1
      - THREADS=8

      # These vars are required: OPENAI_API_KEY, LABEL_STUDIO_API_KEY and LABEL_STUDIO_URL
      - OPENAI_API_KEY=
      - LABEL_STUDIO_API_KEY=

      # LABEL_STUDIO_URL can't be localhost or 0.0.0.0, it should be the public IP of the machine
      # and accessible from the docker container, it always starts with http:// or https://,
      # e.g. http://192.168.1.42:8080
      - LABEL_STUDIO_URL=
    ports:
      - "9090:9090"
    volumes:
      - "./data/server:/data"
